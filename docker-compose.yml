version: '3.8'

services:
  node1:
    build: .
    container_name: edu-chain-node1
    ports:
      - "3001:3001"
      - "6001:6001"
    volumes:
      - ./data/node1:/app/data
    environment:
      - NETWORK=testnet
    restart: unless-stopped

  node2:
    build: .
    container_name: edu-chain-node2
    ports:
      - "3002:3001"
      - "6002:6001"
    volumes:
      - ./data/node2:/app/data
    environment:
      - NETWORK=testnet
    command: ["node", "dist/cli/cli.js", "start", "--data", "/app/data", "--seed", "ws://node1:6001"]
    depends_on:
      - node1
    restart: unless-stopped

  node3:
    build: .
    container_name: edu-chain-node3
    ports:
      - "3003:3001"
      - "6003:6001"
    volumes:
      - ./data/node3:/app/data
    environment:
      - NETWORK=testnet
    command: ["node", "dist/cli/cli.js", "start", "--data", "/app/data", "--seed", "ws://node1:6001"]
    depends_on:
      - node1
    restart: unless-stopped

networks:
  default:
    name: edu-chain-network
